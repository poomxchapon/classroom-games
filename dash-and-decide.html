<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dash & Decide ‚Äî ‡∏ß‡∏¥‡πà‡∏á‡∏â‡∏¥‡∏ß ‡∏ó‡∏∞‡∏•‡∏∏‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0B0B2B;
  --bg-card: #161650;
  --bg-card2: #1E1E5A;
  --text: #F1F5F9;
  --text-dim: #94A3B8;
  --gold: #FBBF24;
  --correct: #4ADE80;
  --wrong: #F87171;
  --radius: 16px;
  --p1: #A855F7; --p1-bg: #581C87; --p1-glow: rgba(168,85,247,0.4);
  --p2: #F43F5E; --p2-bg: #881337; --p2-glow: rgba(244,63,94,0.4);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
*{touch-action:manipulation}
html,body{width:100%;height:100%;overflow:hidden}
body{font-family:'Prompt',sans-serif;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;user-select:none;-webkit-user-select:none}
canvas#stars{position:fixed;inset:0;z-index:0;pointer-events:none}
#confetti{position:fixed;inset:0;pointer-events:none;z-index:100;overflow:hidden}
.confetti-piece{position:absolute;top:-20px;animation:confettiFall linear forwards}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(110vh) rotate(720deg);opacity:0}}

/* ‚îÄ‚îÄ Screens ‚îÄ‚îÄ */
.screen{display:none;flex-direction:column;align-items:center;width:100%;height:100%;position:relative;z-index:1}
.screen.active{display:flex}

/* ‚ïê‚ïê SETUP ‚ïê‚ïê */
#screen-setup{justify-content:center;gap:16px;padding:20px}
.setup-title{font-size:clamp(28px,5vw,48px);font-weight:900;text-align:center;background:linear-gradient(135deg,var(--p1),var(--p2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.setup-sub{font-size:clamp(13px,2vw,18px);color:var(--text-dim);text-align:center;margin-top:-8px}
.setup-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:14px;width:100%;max-width:680px}
.setup-card{background:var(--bg-card);border-radius:var(--radius);padding:16px;border:1px solid rgba(255,255,255,0.08)}
.setup-card h3{font-size:17px;margin-bottom:10px;color:var(--gold)}
.setup-card label{display:block;font-size:13px;color:var(--text-dim);margin-bottom:3px;margin-top:8px}
.setup-card label:first-of-type{margin-top:0}
.setup-card input,.setup-card select{width:100%;padding:7px 11px;background:var(--bg-card2);border:1px solid rgba(255,255,255,0.15);border-radius:8px;color:var(--text);font-family:'Prompt',sans-serif;font-size:15px}
.setup-card select option{background:var(--bg-card2)}
.player-preview{display:flex;gap:10px;margin-top:10px}
.pchip{flex:1;padding:7px;border-radius:8px;text-align:center;font-weight:600;font-size:13px}
.pchip.c1{background:var(--p1-bg);color:var(--p1);border:2px solid var(--p1)}
.pchip.c2{background:var(--p2-bg);color:var(--p2);border:2px solid var(--p2)}

/* SVG BTN */
.svg-btn-container{position:relative;display:flex;justify-content:center;margin-top:4px;animation:svgFloat 3s ease-in-out infinite}
.svg-btn-container:hover{animation-play-state:paused}
.game-svg{cursor:pointer;width:clamp(250px,28vw,380px);overflow:visible}
.svg-btn-container:hover .svg-btn-group{transform:scale(1.05) rotate(-2deg)}
.svg-btn-container:active .svg-btn-group{transform:scale(0.95) translateY(5px)}
.svg-btn-group{transition:transform 0.2s cubic-bezier(0.175,0.885,0.32,1.275)}
.game-svg.is-starting{pointer-events:none}
.svg-btn-container:has(.is-starting){animation:svgPulse 1.5s infinite}
.game-svg.is-starting .svg-btn-content{opacity:0;transition:opacity 0.3s}
.game-svg.is-starting .svg-loading-dots{opacity:1;transition:opacity 0.3s}
@keyframes svgFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
@keyframes svgPulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
.sd1{animation:sdB .6s ease-in-out infinite}.sd2{animation:sdB .6s ease-in-out .15s infinite}.sd3{animation:sdB .6s ease-in-out .3s infinite}
@keyframes sdB{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}

/* ‚ïê‚ïê GAME SCREEN ‚ïê‚ïê */
#screen-game{padding:0}
.game-layout{width:100%;height:100%;display:flex;flex-direction:column}

/* Score Bar */
.score-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:rgba(22,22,80,0.9);border-bottom:2px solid rgba(255,255,255,0.08);flex-shrink:0;z-index:5}
.sb-player{font-size:clamp(15px,2.2vw,22px);font-weight:700;display:flex;align-items:center;gap:6px}
.sb-player.p1{color:var(--p1)}.sb-player.p2{color:var(--p2)}
.sb-center{display:flex;align-items:center;gap:14px;font-size:clamp(13px,1.8vw,18px);color:var(--text-dim)}
.timer-display{font-size:clamp(20px,3vw,30px);font-weight:900;color:var(--gold);min-width:40px;text-align:center}
.timer-display.warning{color:var(--wrong);animation:pulse .5s ease-in-out infinite alternate}
@keyframes pulse{0%{transform:scale(1)}100%{transform:scale(1.15)}}

/* Game Body ‚Äî 3 columns */
.game-body{flex:1;display:grid;grid-template-columns:clamp(130px,16vw,200px) 1fr clamp(130px,16vw,200px);overflow:hidden}

/* Player Panels */
.player-panel{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;padding:12px 8px;background:var(--bg-card);border:2px solid rgba(255,255,255,0.08);position:relative;overflow:hidden}
.player-panel.p1{border-right:3px solid var(--p1);border-left:none;border-top:none;border-bottom:none}
.player-panel.p2{border-left:3px solid var(--p2);border-right:none;border-top:none;border-bottom:none}
.panel-name{font-size:clamp(14px,1.8vw,20px);font-weight:700}
.panel-name.p1{color:var(--p1)}.panel-name.p2{color:var(--p2)}
.panel-score{font-size:clamp(28px,4vw,44px);font-weight:900}
.panel-score.p1{color:var(--p1)}.panel-score.p2{color:var(--p2)}
.panel-btns{display:flex;flex-direction:column;gap:8px;width:100%}
.btn-answer{width:100%;padding:clamp(10px,1.8vh,16px) 8px;border-radius:12px;font-family:'Prompt',sans-serif;font-size:clamp(15px,2vw,22px);font-weight:700;border:3px solid;cursor:pointer;transition:all .15s;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-answer .key-hint{font-size:clamp(11px,1.2vw,14px);font-weight:400;opacity:0.6;background:rgba(0,0,0,0.3);padding:1px 6px;border-radius:4px}
.btn-answer.true-btn{background:rgba(74,222,128,0.12);border-color:var(--correct);color:var(--correct)}
.btn-answer.false-btn{background:rgba(248,113,113,0.12);border-color:var(--wrong);color:var(--wrong)}
.btn-answer:hover:not(:disabled){transform:scale(1.06);filter:brightness(1.2)}
.btn-answer:active:not(:disabled){transform:scale(0.94)}
.btn-answer:disabled{opacity:0.25;cursor:not-allowed;filter:grayscale(0.5)}
.panel-status{font-size:clamp(12px,1.4vw,16px);font-weight:600;text-align:center;min-height:24px}
.status-ready{color:var(--correct)}
.status-answered{color:var(--gold)}
.status-stun{color:var(--wrong);animation:stunPulse .4s ease-in-out infinite alternate}
@keyframes stunPulse{0%{opacity:.5}100%{opacity:1}}

/* Flash on panels */
.player-panel.flash-correct{animation:pFlashG .4s ease-out}
.player-panel.flash-wrong{animation:pFlashR .4s ease-out}
@keyframes pFlashG{0%{box-shadow:inset 0 0 60px rgba(74,222,128,0.5)}100%{box-shadow:none}}
@keyframes pFlashR{0%{box-shadow:inset 0 0 60px rgba(248,113,113,0.5)}100%{box-shadow:none}}

/* Center Area */
.center-area{display:flex;flex-direction:column;overflow:hidden}

/* Track Area */
.track-area{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 20px;gap:6px;min-height:0}
.track-container{width:100%;max-width:1100px}
.track-labels{display:flex;justify-content:space-between;padding:0 4%;margin-bottom:4px;font-size:clamp(10px,1.2vw,14px);color:var(--text-dim);font-weight:600}
.lane{position:relative;height:clamp(50px,8vh,80px);margin-bottom:8px}
.lane-bg{position:absolute;inset:0;background:rgba(255,255,255,0.03);border-radius:40px;border:2px solid rgba(255,255,255,0.06)}
.lane.p1 .lane-bg{border-color:rgba(168,85,247,0.25);box-shadow:inset 0 0 20px rgba(168,85,247,0.08),0 0 10px rgba(168,85,247,0.08)}
.lane.p2 .lane-bg{border-color:rgba(244,63,94,0.25);box-shadow:inset 0 0 20px rgba(244,63,94,0.08),0 0 10px rgba(244,63,94,0.08)}
.step-dot{position:absolute;top:50%;transform:translate(-50%,-50%);width:clamp(8px,1vw,12px);height:clamp(8px,1vw,12px);border-radius:50%;background:rgba(255,255,255,0.12);z-index:2;transition:all .3s}
.step-dot.passed.p1{background:var(--p1);box-shadow:0 0 6px var(--p1-glow)}
.step-dot.passed.p2{background:var(--p2);box-shadow:0 0 6px var(--p2-glow)}
.step-dot.goal-dot{width:clamp(14px,1.6vw,20px);height:clamp(14px,1.6vw,20px);background:var(--gold);box-shadow:0 0 8px rgba(251,191,36,0.4)}

/* Runner */
.runner{position:absolute;top:50%;transform:translate(-50%,-50%);z-index:5;transition:left .5s cubic-bezier(.34,1.56,.64,1)}
.runner-avatar{width:clamp(34px,5vw,50px);height:clamp(34px,5vw,50px);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:clamp(15px,2.2vw,22px);color:#FFF;position:relative}
.runner.p1 .runner-avatar{background:var(--p1);box-shadow:0 0 12px var(--p1-glow),0 0 24px var(--p1-glow)}
.runner.p2 .runner-avatar{background:var(--p2);box-shadow:0 0 12px var(--p2-glow),0 0 24px var(--p2-glow)}
.runner.running{animation:runBob .35s ease-out}
.runner.stumble{animation:stumbleWobble .5s ease-in-out}
.runner.stunned .runner-avatar{opacity:.5;animation:stunnedBlink .3s ease-in-out infinite alternate}
@keyframes runBob{0%,100%{transform:translate(-50%,-50%)}50%{transform:translate(-50%,-65%)}}
@keyframes stumbleWobble{0%{transform:translate(-50%,-50%) rotate(0)}25%{transform:translate(-50%,-50%) rotate(20deg)}50%{transform:translate(-50%,-40%) rotate(-15deg)}75%{transform:translate(-50%,-50%) rotate(8deg)}100%{transform:translate(-50%,-50%) rotate(0)}}
@keyframes stunnedBlink{0%{opacity:.3;filter:brightness(.6)}100%{opacity:.7;filter:brightness(1.4)}}

/* Question Area */
.question-area{flex-shrink:0;padding:14px 20px 18px;background:rgba(0,0,0,0.3);border-top:2px solid rgba(255,255,255,0.08);text-align:center}
.q-text{font-size:clamp(24px,4.5vw,48px);font-weight:900;color:var(--text);margin-bottom:4px;min-height:1.2em;line-height:1.2}
.q-text.pop{animation:qPop .3s ease-out}
@keyframes qPop{0%{transform:scale(1.08);opacity:.5}100%{transform:scale(1);opacity:1}}
.q-hint{font-size:clamp(13px,1.8vw,20px);color:var(--gold);font-weight:600}

/* ‚îÄ‚îÄ Overlays ‚îÄ‚îÄ */
.overlay{position:fixed;inset:0;z-index:50;display:none;align-items:center;justify-content:center;background:rgba(11,11,43,0.92);backdrop-filter:blur(8px)}
.overlay.active{display:flex}
.overlay-content{text-align:center}
#countdown-text{font-size:clamp(80px,15vw,200px);font-weight:900;color:var(--gold);text-shadow:0 0 40px rgba(251,191,36,0.5);animation:countPop .5s ease-out}
@keyframes countPop{0%{transform:scale(2);opacity:0}100%{transform:scale(1);opacity:1}}
.gameover-content{text-align:center;padding:30px}
.gameover-content h2{font-size:clamp(30px,5vw,52px);color:var(--gold);margin-bottom:10px}
.winner-name{font-size:clamp(22px,4vw,40px);font-weight:900;margin-bottom:18px}
.final-scores{display:flex;gap:18px;justify-content:center;margin-bottom:22px;flex-wrap:wrap}
.final-card{background:var(--bg-card);border-radius:var(--radius);padding:16px 28px;min-width:150px;border:3px solid;text-align:center}
.final-card .fc-name{font-size:16px;font-weight:700;margin-bottom:4px}
.final-card .fc-score{font-size:34px;font-weight:900}
.btn-restart{background:linear-gradient(135deg,#FFD54F,#FF8F00);color:#1a1a2e;font-family:'Prompt',sans-serif;font-size:clamp(15px,2.2vw,20px);font-weight:700;padding:12px 36px;border:none;border-radius:40px;cursor:pointer;transition:transform .15s}
.btn-restart:hover{transform:scale(1.05)}.btn-restart:active{transform:scale(0.95)}
.confirm-content{text-align:center;padding:30px}
.confirm-content h2{font-size:clamp(22px,4vw,34px);color:var(--gold);margin-bottom:18px}
.confirm-buttons{display:flex;gap:14px;justify-content:center}
.btn-cy,.btn-cn{font-family:'Prompt',sans-serif;font-size:17px;font-weight:700;padding:11px 28px;border:none;border-radius:30px;cursor:pointer;transition:transform .15s}
.btn-cy{background:var(--wrong);color:#FFF}.btn-cn{background:var(--bg-card2);color:var(--text);border:2px solid rgba(255,255,255,0.2)}
.btn-cy:hover,.btn-cn:hover{transform:scale(1.05)}

/* Win flash */
.win-flash{position:fixed;inset:0;z-index:45;pointer-events:none;opacity:0}
.win-flash.show{animation:winPulse 1s ease-out forwards}
@keyframes winPulse{0%{background:rgba(251,191,36,0.4);opacity:1}100%{background:transparent;opacity:0}}

/* Speed trail */
.speed-trail{position:absolute;height:3px;border-radius:2px;z-index:4;pointer-events:none;animation:trailFade .5s ease-out forwards}
@keyframes trailFade{0%{opacity:.8;width:40px}100%{opacity:0;width:80px}}

@media(prefers-reduced-motion:reduce){.runner,.step-dot,.btn-answer{transition:none!important}.confetti-piece,#countdown-text,.runner.running,.runner.stumble,.runner.stunned .runner-avatar{animation:none!important}}
</style>
</head>
<body>
<canvas id="stars"></canvas>
<div id="confetti"></div>
<div class="win-flash" id="winFlash"></div>

<!-- ‚ïê‚ïê‚ïê SETUP ‚ïê‚ïê‚ïê -->
<div id="screen-setup" class="screen active">
  <div class="setup-title">Dash & Decide</div>
  <div class="setup-sub">‡∏ß‡∏¥‡πà‡∏á‡∏â‡∏¥‡∏ß ‡∏ó‡∏∞‡∏•‡∏∏‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‚Äî ‡∏ï‡∏≠‡∏ö ‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß ‡∏ß‡∏¥‡πà‡∏á‡πÅ‡∏ã‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ä‡∏±‡∏¢!</div>
  <div class="setup-grid">
    <div class="setup-card">
      <h3>2 ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</h3>
      <label>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1 (‡∏õ‡∏∏‡πà‡∏° A / S)</label>
      <input id="inName1" value="‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1" maxlength="20">
      <label>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2 (‡∏õ‡∏∏‡πà‡∏° K / L)</label>
      <input id="inName2" value="‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2" maxlength="20">
      <div class="player-preview">
        <div class="pchip c1" id="chip1">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1</div>
        <div class="pchip c2" id="chip2">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2</div>
      </div>
    </div>
    <div class="setup-card">
      <h3>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
      <label>‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label>
      <select id="inPack">
        <option value="math">üî¢ ‡∏Ñ‡∏ì‡∏¥‡∏ï ‚Äî ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î</option>
        <option value="sci">üî¨ ‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‚Äî ‡∏à‡∏£‡∏¥‡∏á/‡πÄ‡∏ó‡πá‡∏à</option>
        <option value="soc">üåç ‡∏™‡∏±‡∏á‡∏Ñ‡∏° ‚Äî ‡∏à‡∏£‡∏¥‡∏á/‡πÄ‡∏ó‡πá‡∏à</option>
        <option value="eng">üî§ ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‚Äî ‡πÅ‡∏õ‡∏•‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î</option>
      </select>
      <label>‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
      <select id="inTimer">
        <option value="30">30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="45">45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="60" selected>60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="90">90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="120">120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
      </select>
      <label>‡πÄ‡∏™‡πâ‡∏ô‡∏ä‡∏±‡∏¢ (‡∏Å‡πâ‡∏≤‡∏ß)</label>
      <select id="inGoal">
        <option value="8">8 ‡∏Å‡πâ‡∏≤‡∏ß</option>
        <option value="10" selected>10 ‡∏Å‡πâ‡∏≤‡∏ß</option>
        <option value="12">12 ‡∏Å‡πâ‡∏≤‡∏ß</option>
        <option value="15">15 ‡∏Å‡πâ‡∏≤‡∏ß</option>
      </select>
    </div>
  </div>
  <div class="svg-btn-container">
    <svg id="gameBtn" class="game-svg" viewBox="-20 -20 360 160" xmlns="http://www.w3.org/2000/svg" onclick="clickStart()">
      <defs>
        <linearGradient id="bgGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#A855F7"/><stop offset="100%" stop-color="#F43F5E"/></linearGradient>
        <filter id="btnSh" x="-20%" y="-20%" width="140%" height="160%"><feDropShadow dx="0" dy="8" stdDeviation="0" flood-color="#581C87"/></filter>
        <filter id="btnTSh" x="-20%" y="-20%" width="140%" height="160%"><feDropShadow dx="0" dy="2" stdDeviation="1" flood-color="rgba(0,0,0,0.3)"/></filter>
      </defs>
      <g class="svg-btn-group" transform-origin="160 55">
        <rect x="10" y="10" width="300" height="80" rx="40" fill="url(#bgGrad)" filter="url(#btnSh)" stroke="#FFF" stroke-width="5"/>
        <g class="svg-btn-content"><text x="160" y="62" font-family="'Prompt',sans-serif" font-size="30" font-weight="700" fill="#FFF" text-anchor="middle" letter-spacing="1" filter="url(#btnTSh)">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Ç‡πà‡∏á!</text></g>
        <g class="svg-loading-dots" opacity="0" transform="translate(160,55)"><circle class="sd1" cx="-30" cy="0" r="8" fill="#FFF"/><circle class="sd2" cx="0" cy="0" r="8" fill="#FFF"/><circle class="sd3" cx="30" cy="0" r="8" fill="#FFF"/></g>
      </g>
    </svg>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê GAME ‚ïê‚ïê‚ïê -->
<div id="screen-game" class="screen">
  <div class="game-layout">
    <div class="score-bar">
      <div class="sb-player p1" id="sb1">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1: 0</div>
      <div class="sb-center"><span>‚è±</span><div class="timer-display" id="timerDisplay">60</div><span id="qCount">Q 0</span></div>
      <div class="sb-player p2" id="sb2">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2: 0</div>
    </div>
    <div class="game-body">
      <!-- P1 Panel -->
      <div class="player-panel p1" id="panel0">
        <div class="panel-name p1" id="pName0">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1</div>
        <div class="panel-score p1" id="pScore0">0/<span id="pGoal0">10</span></div>
        <div class="panel-btns">
          <button class="btn-answer true-btn" id="btnT0" onclick="playerAnswer(0,true)">‚úì ‡∏ñ‡∏π‡∏Å <span class="key-hint">A</span></button>
          <button class="btn-answer false-btn" id="btnF0" onclick="playerAnswer(0,false)">‚úó ‡∏ú‡∏¥‡∏î <span class="key-hint">S</span></button>
        </div>
        <div class="panel-status" id="pStatus0"><span class="status-ready">‡∏û‡∏£‡πâ‡∏≠‡∏°</span></div>
      </div>
      <!-- Center -->
      <div class="center-area">
        <div class="track-area" id="trackArea"></div>
        <div class="question-area">
          <div class="q-text" id="qText"></div>
          <div class="q-hint">‡∏ñ‡∏π‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏¥‡∏î?</div>
        </div>
      </div>
      <!-- P2 Panel -->
      <div class="player-panel p2" id="panel1">
        <div class="panel-name p2" id="pName1">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2</div>
        <div class="panel-score p2" id="pScore1">0/<span id="pGoal1">10</span></div>
        <div class="panel-btns">
          <button class="btn-answer true-btn" id="btnT1" onclick="playerAnswer(1,true)">‚úì ‡∏ñ‡∏π‡∏Å <span class="key-hint">K</span></button>
          <button class="btn-answer false-btn" id="btnF1" onclick="playerAnswer(1,false)">‚úó ‡∏ú‡∏¥‡∏î <span class="key-hint">L</span></button>
        </div>
        <div class="panel-status" id="pStatus1"><span class="status-ready">‡∏û‡∏£‡πâ‡∏≠‡∏°</span></div>
      </div>
    </div>
  </div>
</div>

<!-- Overlays -->
<div id="overlay-countdown" class="overlay"><div class="overlay-content"><div id="countdown-text">3</div></div></div>
<div id="overlay-gameover" class="overlay">
  <div class="gameover-content">
    <h2>‡∏à‡∏ö‡πÄ‡∏Å‡∏°!</h2>
    <div class="winner-name" id="winnerName"></div>
    <div class="final-scores" id="finalScores"></div>
    <button class="btn-restart" onclick="backToSetup()">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
  </div>
</div>
<div id="overlay-confirm" class="overlay">
  <div class="confirm-content">
    <h2>‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤?</h2>
    <div class="confirm-buttons">
      <button class="btn-cy" onclick="confirmExit(true)">‡πÉ‡∏ä‡πà ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏¢</button>
      <button class="btn-cn" onclick="confirmExit(false)">‡πÑ‡∏°‡πà ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠</button>
    </div>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUESTION DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const TF=(t,a)=>({text:t,answer:a});

const PACKS={
  sci:[
    TF('‡πÇ‡∏•‡∏Å‡∏´‡∏°‡∏∏‡∏ô‡∏£‡∏≠‡∏ö‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå',true),
    TF('‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏°‡∏µ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á',false),
    TF('‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏î‡∏ó‡∏µ‡πà 100¬∞C',true),
    TF('‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏™‡∏∏‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ',false),
    TF('‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡∏§‡∏Å‡∏©‡πå',true),
    TF('‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®',false),
    TF('‡∏ô‡πâ‡∏≥‡∏°‡∏µ 3 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á ‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß ‡∏Å‡πä‡∏≤‡∏ã',true),
    TF('‡πÅ‡∏™‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á',true),
    TF('‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á',true),
    TF('‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏•‡∏π‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏°‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î‡∏ß‡∏≤‡∏á‡πÑ‡∏Ç‡πà',false),
    TF('‡πÄ‡∏û‡∏ä‡∏£‡πÅ‡∏Ç‡πá‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏´‡∏•‡πá‡∏Å',true),
    TF('‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏ß‡πà‡∏≤‡πÇ‡∏•‡∏Å',false),
    TF('‡∏û‡∏∑‡∏ä‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏™‡∏á',true),
    TF('‡∏õ‡∏•‡∏≤‡∏ß‡∏≤‡∏¨‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏•‡∏≤',false),
    TF('‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏Å',false),
    TF('‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏°‡∏µ 206 ‡∏ä‡∏¥‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å',true),
    TF('‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á‡∏°‡∏µ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ H‚ÇÇO',false),
    TF('‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡∏•‡∏á‡∏™‡∏π‡πà‡∏û‡∏∑‡πâ‡∏ô',true),
    TF('‡πÑ‡∏î‡πÇ‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå‡∏Å‡∏±‡∏ö‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡πÄ‡∏Ñ‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏¢‡∏∏‡∏Ñ‡∏Å‡∏±‡∏ô',false),
    TF('‡∏™‡∏°‡∏≠‡∏á‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20% ‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢',true),
    TF('‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 0¬∞C ‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥',true),
    TF('‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏≥‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÑ‡∏î‡πâ',true),
    TF('‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ö‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏î‡∏ß‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå',false),
    TF('‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏´‡∏•‡πá‡∏Å',true),
  ],
  soc:[
    TF('‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡∏∞‡∏¢‡∏≤‡πÑ‡∏´‡∏•‡∏•‡∏á‡∏™‡∏π‡πà‡∏≠‡πà‡∏≤‡∏ß‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡∏°‡∏µ 77 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏•‡∏≤‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡πÉ‡∏ï‡πâ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',false),
    TF('‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÅ‡∏õ‡∏ã‡∏¥‡∏ü‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏à‡∏µ‡∏ô‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏≤‡∏Å‡∏≠‡∏ß‡∏Å‡∏≤‡∏®‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≤‡πÄ‡∏õ‡∏•‡πà‡∏≤',false),
    TF('‡∏ó‡∏ß‡∏µ‡∏õ‡πÅ‡∏≠‡∏ü‡∏£‡∏¥‡∏Å‡∏≤‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ‡πÅ‡∏´‡πà‡∏á‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡∏¢‡∏∏‡πÇ‡∏£‡∏õ',false),
    TF('‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 6 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',true),
    TF('‡∏î‡∏≠‡∏¢‡∏≠‡∏¥‡∏ô‡∏ó‡∏ô‡∏ô‡∏ó‡πå‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢',true),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÑ‡∏ô‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢',false),
    TF('‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å 10 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',true),
    TF('‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡∏ó‡∏ß‡∏µ‡∏õ',true),
    TF('‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥‡πÑ‡∏ó‡∏¢‡∏°‡∏µ 4 ‡∏™‡∏µ',false),
    TF('‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÄ‡∏≠‡πÄ‡∏ß‡∏≠‡πÄ‡∏£‡∏™‡∏ï‡πå‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏û‡∏£‡∏∞‡∏ö‡∏£‡∏°‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä‡∏ß‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',false),
    TF('‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏™‡∏∞‡∏Æ‡∏≤‡∏£‡∏≤‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡∏°‡∏µ‡∏û‡∏£‡∏°‡πÅ‡∏î‡∏ô‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ö 4 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',true),
    TF('‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏≠‡∏ã‡∏≤‡∏Å‡∏≤',false),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÇ‡∏Ç‡∏á‡πÑ‡∏´‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ö‡∏£‡∏π‡πÑ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô',true),
    TF('‡∏ó‡∏ß‡∏µ‡∏õ‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏™‡∏°‡∏±‡∏¢‡∏£‡∏±‡∏ä‡∏Å‡∏≤‡∏•‡∏ó‡∏µ‡πà 5',false),
    TF('‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡πÉ‡∏ï‡πâ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
  ],
  eng:[
    TF('"Cat" = ‡πÅ‡∏°‡∏ß',true),TF('"Dog" = ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç',true),TF('"Sun" = ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå',true),
    TF('"Moon" = ‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå',true),TF('"Star" = ‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß',true),TF('"Fish" = ‡∏õ‡∏•‡∏≤',true),
    TF('"Bird" = ‡∏ô‡∏Å',true),TF('"Water" = ‡∏ô‡πâ‡∏≥',true),TF('"Fire" = ‡πÑ‡∏ü',true),
    TF('"Book" = ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠',true),TF('"Apple" = ‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•',true),TF('"School" = ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',true),
    TF('"Teacher" = ‡∏Ñ‡∏£‡∏π',true),TF('"Big" = ‡πÉ‡∏´‡∏ç‡πà',true),TF('"Small" = ‡πÄ‡∏•‡πá‡∏Å',true),
    TF('"Cat" = ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç',false),TF('"Dog" = ‡∏ô‡∏Å',false),TF('"Sun" = ‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå',false),
    TF('"Moon" = ‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß',false),TF('"Star" = ‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå',false),TF('"Fish" = ‡∏Å‡∏∏‡πâ‡∏á',false),
    TF('"Bird" = ‡∏õ‡∏•‡∏≤',false),TF('"Water" = ‡πÑ‡∏ü',false),TF('"Fire" = ‡∏ô‡πâ‡∏≥',false),
    TF('"Book" = ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤',false),TF('"Apple" = ‡∏™‡πâ‡∏°',false),TF('"School" = ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',false),
    TF('"Teacher" = ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',false),TF('"Big" = ‡πÄ‡∏•‡πá‡∏Å',false),TF('"Small" = ‡πÉ‡∏´‡∏ç‡πà',false),
    TF('"Hand" = ‡∏°‡∏∑‡∏≠',true),TF('"Hand" = ‡πÄ‡∏ó‡πâ‡∏≤',false),
    TF('"Egg" = ‡πÑ‡∏Ç‡πà',true),TF('"Egg" = ‡∏ô‡∏°',false),
    TF('"Rain" = ‡∏ù‡∏ô',true),TF('"Rain" = ‡∏´‡∏¥‡∏°‡∏∞',false),
    TF('"Red" = ‡πÅ‡∏î‡∏á',true),TF('"Red" = ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß',false),
    TF('"Happy" = ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç',true),TF('"Happy" = ‡πÄ‡∏®‡∏£‡πâ‡∏≤',false),
  ],
};

/* ‚ïê‚ïê‚ïê MATH TF GENERATOR ‚ïê‚ïê‚ïê */
function randInt(a,b){return a+Math.floor(Math.random()*(b-a+1))}
function shuffle(arr){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

function genMathTF(){
  const ops=['+','-','√ó'];
  const op=ops[randInt(0,2)];
  let a,b,ans;
  if(op==='+'){a=randInt(2,30);b=randInt(2,30);ans=a+b}
  else if(op==='-'){a=randInt(10,50);b=randInt(1,a);ans=a-b}
  else{a=randInt(2,12);b=randInt(2,9);ans=a*b}
  const isTrue=Math.random()>0.45;
  let shown=ans;
  if(!isTrue){
    let off;
    do{off=randInt(1,5)*(Math.random()>.5?1:-1)}while(ans+off<0);
    shown=ans+off;
  }
  return{text:`${a} ${op} ${b} = ${shown}`,answer:isTrue};
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GAME STATE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const G={
  state:'setup',
  players:[
    {name:'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1',steps:0,answered:false,stunUntil:0},
    {name:'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2',steps:0,answered:false,stunUntil:0}
  ],
  goal:10,
  timerMax:60,timerLeft:60,timerInterval:null,
  pack:'math',
  questions:[],qIndex:0,currentQ:null,
  qCount:0,
  nextQScheduled:false,
  stunInterval:null,
  pausedState:null,
};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUDIO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let audioCtx=null;
function ensureAudio(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();if(audioCtx.state==='suspended')audioCtx.resume()}
function playTone(f,d,t='sine',v=0.18){ensureAudio();const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.connect(g);g.connect(audioCtx.destination);o.type=t;o.frequency.setValueAtTime(f,audioCtx.currentTime);g.gain.setValueAtTime(v,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+d);o.start();o.stop(audioCtx.currentTime+d)}
function sfxCountdown(){playTone(440,.15,'square',.12)}
function sfxGo(){playTone(880,.3,'square',.15);setTimeout(()=>playTone(1100,.3,'square',.12),100)}
function sfxCorrect(){playTone(523,.1);setTimeout(()=>playTone(659,.1),80);setTimeout(()=>playTone(784,.15),160)}
function sfxWrong(){playTone(200,.25,'sawtooth',.2);setTimeout(()=>playTone(150,.35,'sawtooth',.15),150)}
function sfxStun(){playTone(120,.1,'square',.15);setTimeout(()=>playTone(80,.15,'square',.1),60);setTimeout(()=>playTone(60,.2,'square',.08),120)}
function sfxUnstun(){playTone(400,.08);setTimeout(()=>playTone(600,.1),60)}
function sfxStep(){playTone(660,.08);setTimeout(()=>playTone(880,.1),50)}
function sfxWin(){[523,659,784,1047].forEach((f,i)=>setTimeout(()=>playTone(f,.3,'triangle',.15),i*120))}
function sfxTick(){playTone(900,.05,'sine',.08)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STARS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function initStars(){const c=document.getElementById('stars');const ctx=c.getContext('2d');function resize(){c.width=innerWidth;c.height=innerHeight}resize();addEventListener('resize',resize);const stars=Array.from({length:150},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.8+.3,a:Math.random(),s:(Math.random()*.015+.003)*(Math.random()<.5?1:-1)}));(function draw(){ctx.clearRect(0,0,c.width,c.height);stars.forEach(s=>{s.a+=s.s;if(s.a>1||s.a<.1)s.s*=-1;ctx.fillStyle=`rgba(255,255,255,${s.a})`;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill()});requestAnimationFrame(draw)}())}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function showScreen(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active')}
function showOverlay(id){document.getElementById(id).classList.add('active')}
function hideOverlay(id){document.getElementById(id).classList.remove('active')}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFETTI ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function launchConfetti(){const c=document.getElementById('confetti');c.innerHTML='';const colors=['#A855F7','#F43F5E','#4ADE80','#FBBF24','#F87171','#C084FC','#F472B6','#22D3EE'];for(let i=0;i<80;i++){const p=document.createElement('div');p.className='confetti-piece';p.style.left=Math.random()*100+'%';p.style.background=colors[Math.floor(Math.random()*colors.length)];p.style.width=(6+Math.random()*10)+'px';p.style.height=(6+Math.random()*10)+'px';p.style.borderRadius=Math.random()>.5?'50%':'2px';p.style.animationDuration=(2+Math.random()*3)+'s';p.style.animationDelay=Math.random()*2+'s';p.style.opacity=.7+Math.random()*.3;c.appendChild(p)}setTimeout(()=>c.innerHTML='',7500)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TIMER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function startTimer(resume=false){if(!resume)G.timerLeft=G.timerMax;updateTimerDisplay();clearInterval(G.timerInterval);G.timerInterval=setInterval(()=>{G.timerLeft--;updateTimerDisplay();if(G.timerLeft<=5&&G.timerLeft>0)sfxTick();if(G.timerLeft<=0){clearInterval(G.timerInterval);onTimeUp()}},1000)}
function stopTimer(){clearInterval(G.timerInterval)}
function updateTimerDisplay(){const el=document.getElementById('timerDisplay');el.textContent=G.timerLeft;el.classList.toggle('warning',G.timerLeft<=5)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TRACK RENDERING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function getStepPct(step){return 6+(step/G.goal)*88}

function renderTrack(){
  const area=document.getElementById('trackArea');
  area.innerHTML='';
  // Labels
  const labels=document.createElement('div');
  labels.className='track-labels';
  labels.innerHTML='<span>START</span><span>FINISH</span>';
  area.appendChild(labels);
  // Container
  const container=document.createElement('div');
  container.className='track-container';
  for(let p=0;p<2;p++){
    const lane=document.createElement('div');
    lane.className=`lane p${p+1}`;
    lane.id=`lane${p}`;
    const bg=document.createElement('div');
    bg.className='lane-bg';
    lane.appendChild(bg);
    // Step dots
    for(let s=0;s<=G.goal;s++){
      const dot=document.createElement('div');
      dot.className='step-dot';
      if(s===G.goal)dot.classList.add('goal-dot');
      dot.id=`dot-${p}-${s}`;
      dot.style.left=getStepPct(s)+'%';
      lane.appendChild(dot);
    }
    // Runner
    const runner=document.createElement('div');
    runner.className=`runner p${p+1}`;
    runner.id=`runner${p}`;
    runner.style.left=getStepPct(0)+'%';
    runner.innerHTML=`<div class="runner-avatar">${p+1}</div>`;
    lane.appendChild(runner);
    container.appendChild(lane);
  }
  area.appendChild(container);
}

function updateTrack(){
  for(let p=0;p<2;p++){
    const runner=document.getElementById(`runner${p}`);
    if(runner)runner.style.left=getStepPct(G.players[p].steps)+'%';
    for(let s=0;s<=G.goal;s++){
      const dot=document.getElementById(`dot-${p}-${s}`);
      if(dot){
        dot.classList.toggle('passed',s<G.players[p].steps);
        dot.classList.toggle(`p${p+1}`,s<G.players[p].steps);
      }
    }
  }
}

function updateScores(){
  for(let p=0;p<2;p++){
    document.getElementById(`pScore${p}`).innerHTML=`${G.players[p].steps}/<span id="pGoal${p}">${G.goal}</span>`;
    document.getElementById(`sb${p+1}`).textContent=`${G.players[p].name}: ${G.players[p].steps}/${G.goal}`;
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RUNNER ANIMATIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function animateRun(idx){
  const r=document.getElementById(`runner${idx}`);
  r.classList.remove('running','stumble');
  void r.offsetHeight;
  r.classList.add('running');
  sfxStep();
  // Speed trail
  const lane=document.getElementById(`lane${idx}`);
  const pct=getStepPct(G.players[idx].steps);
  const trail=document.createElement('div');
  trail.className='speed-trail';
  trail.style.top='50%';
  trail.style.left=(pct-3)+'%';
  trail.style.transform='translateY(-50%)';
  trail.style.background=idx===0?'var(--p1)':'var(--p2)';
  lane.appendChild(trail);
  setTimeout(()=>{r.classList.remove('running');trail.remove()},500);
}

function animateStumble(idx){
  const r=document.getElementById(`runner${idx}`);
  r.classList.remove('running','stumble');
  void r.offsetHeight;
  r.classList.add('stumble');
  sfxStun();
  setTimeout(()=>r.classList.remove('stumble'),500);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLAYER PANEL UPDATES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function updatePlayerPanels(){
  const now=Date.now();
  for(let i=0;i<2;i++){
    const p=G.players[i];
    const statusEl=document.getElementById(`pStatus${i}`);
    const btnT=document.getElementById(`btnT${i}`);
    const btnF=document.getElementById(`btnF${i}`);
    const runner=document.getElementById(`runner${i}`);
    if(now<p.stunUntil){
      const left=((p.stunUntil-now)/1000).toFixed(1);
      statusEl.innerHTML=`<span class="status-stun">‚ö° STUN! ${left}s</span>`;
      btnT.disabled=true;btnF.disabled=true;
      if(runner)runner.classList.add('stunned');
    } else if(p.answered){
      statusEl.innerHTML=`<span class="status-answered">‚úì ‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</span>`;
      btnT.disabled=true;btnF.disabled=true;
      if(runner)runner.classList.remove('stunned');
    } else {
      statusEl.innerHTML=`<span class="status-ready">‡∏û‡∏£‡πâ‡∏≠‡∏°!</span>`;
      btnT.disabled=false;btnF.disabled=false;
      if(runner)runner.classList.remove('stunned');
    }
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STUN INTERVAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function startStunCheck(){
  clearInterval(G.stunInterval);
  G.stunInterval=setInterval(()=>{
    if(G.state!=='playing')return;
    const now=Date.now();
    let changed=false;
    for(let i=0;i<2;i++){
      const p=G.players[i];
      if(p.stunUntil>0&&now>=p.stunUntil){
        p.stunUntil=0;
        changed=true;
        sfxUnstun();
      }
    }
    if(changed)updatePlayerPanels();
    // Update stun countdown display
    for(let i=0;i<2;i++){
      const p=G.players[i];
      if(now<p.stunUntil){
        const left=((p.stunUntil-now)/1000).toFixed(1);
        const statusEl=document.getElementById(`pStatus${i}`);
        statusEl.innerHTML=`<span class="status-stun">‚ö° STUN! ${left}s</span>`;
      }
    }
  },50);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê START ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function clickStart(){
  ensureAudio();
  const btn=document.getElementById('gameBtn');
  if(btn.classList.contains('is-starting'))return;
  btn.classList.add('is-starting');

  G.players[0].name=document.getElementById('inName1').value.trim()||'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1';
  G.players[1].name=document.getElementById('inName2').value.trim()||'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2';
  G.players[0].steps=0;G.players[1].steps=0;
  G.players[0].answered=false;G.players[1].answered=false;
  G.players[0].stunUntil=0;G.players[1].stunUntil=0;
  G.pack=document.getElementById('inPack').value;
  G.timerMax=parseInt(document.getElementById('inTimer').value);
  G.goal=parseInt(document.getElementById('inGoal').value);
  G.qCount=0;G.qIndex=0;G.nextQScheduled=false;G.currentQ=null;

  if(G.pack!=='math'){G.questions=shuffle([...PACKS[G.pack]])}

  // Update labels
  document.getElementById('pName0').textContent=G.players[0].name;
  document.getElementById('pName1').textContent=G.players[1].name;
  document.getElementById('sb1').textContent=`${G.players[0].name}: 0/${G.goal}`;
  document.getElementById('sb2').textContent=`${G.players[1].name}: 0/${G.goal}`;
  updateScores();

  renderTrack();
  updateTrack();

  setTimeout(()=>{
    btn.classList.remove('is-starting');
    showScreen('screen-game');
    runCountdown();
  },700);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COUNTDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function runCountdown(){
  showOverlay('overlay-countdown');
  const el=document.getElementById('countdown-text');
  let count=3;el.textContent=count;el.style.color='var(--gold)';sfxCountdown();
  const iv=setInterval(()=>{
    count--;
    if(count>0){el.textContent=count;el.style.animation='none';el.offsetHeight;el.style.animation='';sfxCountdown()}
    else{
      el.textContent='GO!';el.style.animation='none';el.offsetHeight;el.style.animation='';el.style.color='var(--correct)';sfxGo();
      clearInterval(iv);
      setTimeout(()=>{hideOverlay('overlay-countdown');el.style.color='var(--gold)';G.state='playing';startTimer();startStunCheck();loadQuestion()},600);
    }
  },800);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUESTIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function getNextQuestion(){
  if(G.pack==='math')return genMathTF();
  if(G.qIndex>=G.questions.length){G.questions=shuffle(G.questions);G.qIndex=0}
  return G.questions[G.qIndex++];
}

function loadQuestion(){
  if(G.state!=='playing')return;
  G.currentQ=getNextQuestion();
  G.qCount++;
  G.nextQScheduled=false;

  // Reset answered state
  G.players[0].answered=false;
  G.players[1].answered=false;

  // Update question display
  const qEl=document.getElementById('qText');
  qEl.textContent=G.currentQ.text;
  qEl.classList.remove('pop');void qEl.offsetHeight;qEl.classList.add('pop');
  document.getElementById('qCount').textContent=`Q ${G.qCount}`;

  updatePlayerPanels();
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ANSWER LOGIC ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function playerAnswer(idx,answeredTrue){
  const p=G.players[idx];
  if(G.state!=='playing')return;
  if(p.answered)return;
  if(Date.now()<p.stunUntil)return;

  p.answered=true;
  const isCorrect=(answeredTrue===G.currentQ.answer);
  const panel=document.getElementById(`panel${idx}`);

  if(isCorrect){
    p.steps++;
    sfxCorrect();
    animateRun(idx);
    updateTrack();
    updateScores();
    panel.classList.remove('flash-correct','flash-wrong');void panel.offsetHeight;
    panel.classList.add('flash-correct');
    setTimeout(()=>panel.classList.remove('flash-correct'),400);

    if(p.steps>=G.goal){
      G.state='gameOver';
      stopTimer();clearInterval(G.stunInterval);
      const fl=document.getElementById('winFlash');fl.classList.add('show');setTimeout(()=>fl.classList.remove('show'),1200);
      setTimeout(()=>showGameOver(idx),800);
      return;
    }
  } else {
    p.stunUntil=Date.now()+2000;
    animateStumble(idx);
    panel.classList.remove('flash-correct','flash-wrong');void panel.offsetHeight;
    panel.classList.add('flash-wrong');
    setTimeout(()=>panel.classList.remove('flash-wrong'),400);
  }

  updatePlayerPanels();
  checkNextQuestion();
}

function checkNextQuestion(){
  if(G.nextQScheduled)return;
  if(G.players[0].answered&&G.players[1].answered){
    G.nextQScheduled=true;
    setTimeout(()=>{
      G.nextQScheduled=false;
      if(G.state==='playing')loadQuestion();
    },500);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WIN CONDITIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function onTimeUp(){
  if(G.state!=='playing')return;
  // Defer by one macrotask so any pending answer events in queue process first
  setTimeout(()=>{
    if(G.state!=='playing')return; // Already won during the defer
    G.state='gameOver';
    clearInterval(G.stunInterval);
    const s0=G.players[0].steps,s1=G.players[1].steps;
    const winner=s0>s1?0:s1>s0?1:-1;
    setTimeout(()=>showGameOver(winner),500);
  },0);
}

function showGameOver(winnerIdx){
  if(winnerIdx!==-1){sfxWin();launchConfetti()}
  else{playTone(440,.3,'triangle',.1)}
  const wn=document.getElementById('winnerName');
  if(winnerIdx===-1){
    wn.textContent='‡πÄ‡∏™‡∏°‡∏≠!';wn.style.color='var(--gold)';
  } else {
    wn.textContent=`${G.players[winnerIdx].name} ‡∏ä‡∏ô‡∏∞!`;
    wn.style.color=winnerIdx===0?'var(--p1)':'var(--p2)';
  }
  const sc=document.getElementById('finalScores');
  sc.innerHTML='';
  G.players.forEach((p,i)=>{
    const c=document.createElement('div');
    c.className='final-card';
    c.style.borderColor=i===0?'var(--p1)':'var(--p2)';
    c.innerHTML=`<div class="fc-name" style="color:${i===0?'var(--p1)':'var(--p2)'}">${p.name}</div><div class="fc-score" style="color:${i===0?'var(--p1)':'var(--p2)'}">${p.steps}/${G.goal}</div>`;
    sc.appendChild(c);
  });
  showOverlay('overlay-gameover');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HELPERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function backToSetup(){
  hideOverlay('overlay-gameover');hideOverlay('overlay-confirm');
  stopTimer();clearInterval(G.stunInterval);
  G.state='setup';G.pausedState=null;
  showScreen('screen-setup');
}

function showConfirmExit(){
  if(G.state==='setup'||G.state==='gameOver')return;
  G.pausedState=G.state;G.state='paused';
  stopTimer();
  // Freeze stun as remaining ms so pausing doesn't cancel stuns
  const now=Date.now();
  for(let i=0;i<2;i++){const p=G.players[i];p._stunRemaining=p.stunUntil>now?p.stunUntil-now:0}
  showOverlay('overlay-confirm');
}
function confirmExit(yes){
  hideOverlay('overlay-confirm');
  if(yes){backToSetup()}
  else{
    G.state=G.pausedState||'playing';G.pausedState=null;
    // Restore stun timestamps from frozen remaining
    const now=Date.now();
    for(let i=0;i<2;i++){if(G.players[i]._stunRemaining>0)G.players[i].stunUntil=now+G.players[i]._stunRemaining}
    startTimer(true);updatePlayerPanels();
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê KEYBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.addEventListener('keydown',e=>{
  const k=e.key.toLowerCase();
  if(G.state==='playing'){
    if(k==='a')playerAnswer(0,true);
    else if(k==='s')playerAnswer(0,false);
    else if(k==='k')playerAnswer(1,true);
    else if(k==='l')playerAnswer(1,false);
  }
  if(k==='escape'){
    if(G.state==='paused')confirmExit(false);
    else if(G.state!=='setup'&&G.state!=='gameOver')showConfirmExit();
  }
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PREVIEW CHIPS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.getElementById('inName1').addEventListener('input',e=>{document.getElementById('chip1').textContent=e.target.value||'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 1'});
document.getElementById('inName2').addEventListener('input',e=>{document.getElementById('chip2').textContent=e.target.value||'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 2'});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
initStars();
</script>
</body>
</html>
