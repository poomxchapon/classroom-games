<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rocket Launch ‚Äî ‡∏à‡∏£‡∏ß‡∏î‡∏ó‡∏∞‡∏•‡∏∏‡∏≠‡∏ß‡∏Å‡∏≤‡∏®</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0B0B2B;
  --bg-card: #161650;
  --bg-card2: #1E1E5A;
  --text: #F1F5F9;
  --text-dim: #94A3B8;
  --gold: #FBBF24;
  --correct: #4ADE80;
  --wrong: #F87171;
  --radius: 16px;
  --team1: #EF4444; --team1-bg: #7F1D1D;
  --team2: #3B82F6; --team2-bg: #1E3A5F;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow:hidden;touch-action:manipulation}
body{font-family:'Prompt',sans-serif;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;user-select:none;-webkit-user-select:none}
#stars{position:fixed;inset:0;z-index:0;pointer-events:none}
.screen{display:none;position:fixed;inset:0;z-index:1;overflow-y:auto}
.screen.active{display:flex;flex-direction:column;align-items:center;justify-content:center}

/* ‚îÄ‚îÄ SETUP ‚îÄ‚îÄ */
#screen-setup{padding:20px;gap:16px}
.setup-title{font-size:clamp(28px,5vw,48px);font-weight:900;text-align:center;text-shadow:0 0 30px rgba(251,191,36,0.4);color:var(--gold)}
.setup-sub{font-size:clamp(13px,2vw,18px);color:var(--text-dim);text-align:center;margin-top:-8px}
.setup-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:14px;width:100%;max-width:680px}
.setup-card{background:var(--bg-card);border-radius:var(--radius);padding:16px;border:1px solid rgba(255,255,255,0.08)}
.setup-card h3{font-size:17px;margin-bottom:10px;color:var(--gold)}
.setup-card label{display:block;font-size:13px;color:var(--text-dim);margin-bottom:3px;margin-top:8px}
.setup-card label:first-of-type{margin-top:0}
.setup-card input,.setup-card select{width:100%;padding:7px 11px;background:var(--bg-card2);border:1px solid rgba(255,255,255,0.15);border-radius:8px;color:var(--text);font-family:'Prompt',sans-serif;font-size:15px}
.setup-card select option{background:var(--bg-card2)}
.team-preview{display:flex;gap:10px;margin-top:10px}
.team-chip{flex:1;padding:7px;border-radius:8px;text-align:center;font-weight:600;font-size:13px}
.team-chip.red{background:var(--team1-bg);color:var(--team1);border:2px solid var(--team1)}
.team-chip.blue{background:var(--team2-bg);color:var(--team2);border:2px solid var(--team2)}

/* SVG BTN */
.svg-btn-container{width:clamp(250px,50vw,370px);cursor:pointer;margin-top:4px}
.game-svg{width:100%;height:auto;display:block;overflow:visible}
.svg-btn-group{transition:transform 0.1s}
.game-svg:hover .svg-btn-group{transform:scale(1.04)}
.game-svg:active .svg-btn-group{transform:scale(0.97) translateY(4px)}
.game-svg.is-starting .svg-btn-content{opacity:0}
.game-svg.is-starting .svg-loading-dots{opacity:1!important}
.sd1,.sd2,.sd3{animation:dotBounce 1.2s ease-in-out infinite}
.sd2{animation-delay:.15s}.sd3{animation-delay:.3s}
@keyframes dotBounce{0%,80%,100%{transform:translateY(0)}40%{transform:translateY(-12px)}}

/* ‚îÄ‚îÄ GAME SCREEN ‚îÄ‚îÄ */
#screen-game{padding:0}
.game-layout{width:100%;height:100%;display:flex;flex-direction:column}

/* Score Bar */
.score-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:rgba(22,22,80,0.9);border-bottom:2px solid rgba(255,255,255,0.08);flex-shrink:0;z-index:5}
.score-team{font-size:clamp(15px,2.2vw,22px);font-weight:700;display:flex;align-items:center;gap:6px}
.score-team.red{color:var(--team1)}.score-team.blue{color:var(--team2)}
.score-center{display:flex;align-items:center;gap:14px;font-size:clamp(13px,1.8vw,18px);color:var(--text-dim)}
.timer-display{font-size:clamp(20px,3vw,30px);font-weight:900;color:var(--gold);min-width:40px;text-align:center}
.timer-display.warning{color:var(--wrong);animation:pulse .5s ease-in-out infinite alternate}
@keyframes pulse{0%{transform:scale(1)}100%{transform:scale(1.15)}}

/* ‚îÄ‚îÄ RACE TRACK ‚îÄ‚îÄ */
.race-area{flex:1;position:relative;overflow:hidden;min-height:180px}
/* finish line */
.finish-line{position:absolute;top:6%;left:8%;right:8%;border-top:2px dashed rgba(251,191,36,0.4);z-index:2}
.finish-label{position:absolute;top:1%;left:50%;transform:translateX(-50%);z-index:3;display:flex;align-items:center;gap:6px;font-size:clamp(12px,1.6vw,18px);color:var(--gold);font-weight:700;opacity:0.8}
/* level lines */
.level-line{position:absolute;left:12%;right:12%;height:1px;background:rgba(255,255,255,0.06);z-index:1}
/* launchpad */
.launchpad{position:absolute;bottom:0;left:10%;right:10%;height:3px;background:rgba(255,255,255,0.15);z-index:2}
.launchpad-label{position:absolute;bottom:6px;left:50%;transform:translateX(-50%);font-size:clamp(10px,1.2vw,13px);color:var(--text-dim);opacity:0.6;white-space:nowrap;z-index:2}

/* Rockets */
.rocket-col{position:absolute;bottom:0;width:clamp(44px,7vw,80px);z-index:4;transition:bottom 0.6s cubic-bezier(0.34,1.56,0.64,1)}
#rocket1{left:22%;transform:translateX(-50%)}
#rocket2{right:22%;transform:translateX(50%)}
.rocket-col.shake{animation:rocketShake .4s ease-in-out}
@keyframes rocketShake{0%,100%{transform:translateX(-50%)}20%{transform:translateX(calc(-50% - 8px))}40%{transform:translateX(calc(-50% + 8px))}60%{transform:translateX(calc(-50% - 5px))}80%{transform:translateX(calc(-50% + 5px))}}
#rocket2.shake{animation-name:rocketShake2}
@keyframes rocketShake2{0%,100%{transform:translateX(50%)}20%{transform:translateX(calc(50% - 8px))}40%{transform:translateX(calc(50% + 8px))}60%{transform:translateX(calc(50% - 5px))}80%{transform:translateX(calc(50% + 5px))}}
.rocket-label{text-align:center;font-size:clamp(10px,1.4vw,14px);font-weight:700;margin-bottom:2px;white-space:nowrap}
.rocket-label.red{color:var(--team1)}.rocket-label.blue{color:var(--team2)}
.rocket-svg{width:100%;height:auto;display:block;filter:drop-shadow(0 0 8px rgba(99,102,241,0.3))}
.rocket-flame{opacity:0;transition:opacity 0.15s}
.rocket-col.boosting .rocket-flame{opacity:1}
.flame-outer,.flame-mid,.flame-inner{transform-origin:center top}
.rocket-col.boosting .flame-outer{animation:flameFlicker .15s ease-in-out infinite alternate}
.rocket-col.boosting .flame-mid{animation:flameFlicker .12s ease-in-out infinite alternate-reverse}
@keyframes flameFlicker{0%{transform:scaleY(1) scaleX(1)}100%{transform:scaleY(1.3) scaleX(0.85)}}

/* Level badge */
.level-badge{position:absolute;bottom:-2px;left:50%;transform:translateX(-50%);background:var(--bg-card);border:2px solid var(--gold);border-radius:10px;padding:1px 8px;font-size:clamp(10px,1.2vw,13px);font-weight:700;color:var(--gold);white-space:nowrap;z-index:5}

/* ‚îÄ‚îÄ QUESTION AREA ‚îÄ‚îÄ */
.question-area{flex-shrink:0;padding:8px 16px 12px;z-index:5;background:rgba(22,22,80,0.85);border-top:2px solid rgba(255,255,255,0.08)}
.q-text{font-size:clamp(18px,3vw,30px);font-weight:700;text-align:center;color:var(--text);margin-bottom:8px;min-height:1.2em}
.answers{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;max-width:700px;margin:0 auto 8px}
.ans-btn{flex:1 1 calc(50% - 8px);max-width:calc(50% - 8px);min-height:clamp(40px,5vh,56px);border-radius:var(--radius);font-family:'Prompt',sans-serif;font-size:clamp(15px,2.2vw,22px);font-weight:700;border:3px solid rgba(255,255,255,0.15);background:var(--bg-card2);color:var(--text);cursor:default;transition:all 0.15s;touch-action:manipulation;display:flex;align-items:center;justify-content:center;padding:4px 8px;text-align:center;opacity:0.4;pointer-events:none}
.ans-btn.active{opacity:1;cursor:pointer;pointer-events:auto;border-color:rgba(255,255,255,0.3)}
.ans-btn.active:hover{background:#2D2D7A;border-color:var(--gold)}
.ans-btn.active:active{transform:scale(0.96)}
.ans-btn.correct-flash{background:rgba(74,222,128,0.3);border-color:var(--correct);color:var(--correct)}
.ans-btn.wrong-flash{background:rgba(248,113,113,0.3);border-color:var(--wrong);color:var(--wrong)}

/* Buzz */
.buzz-row{display:flex;gap:12px;max-width:600px;margin:0 auto;width:100%}
.buzz-btn{flex:1;padding:clamp(8px,1.5vw,14px);border-radius:var(--radius);font-family:'Prompt',sans-serif;font-size:clamp(14px,2.2vw,20px);font-weight:700;border:3px solid;cursor:pointer;transition:all .15s;touch-action:manipulation}
.buzz-btn:active{transform:scale(0.95)}
.buzz-btn.red{background:var(--team1-bg);color:var(--team1);border-color:var(--team1)}
.buzz-btn.red:hover{background:#991B1B}
.buzz-btn.blue{background:var(--team2-bg);color:var(--team2);border-color:var(--team2)}
.buzz-btn.blue:hover{background:#1E40AF}
.buzz-btn:disabled{opacity:0.3;cursor:not-allowed;transform:none}
.status-text{text-align:center;font-size:clamp(13px,1.8vw,18px);color:var(--text-dim);margin-bottom:6px}
.status-text.active-team{font-weight:700;font-size:clamp(15px,2.2vw,22px)}
.status-text.red{color:var(--team1)}.status-text.blue{color:var(--team2)}

/* ‚îÄ‚îÄ OVERLAYS ‚îÄ‚îÄ */
.overlay{position:fixed;inset:0;z-index:50;display:none;align-items:center;justify-content:center;background:rgba(11,11,43,0.92);backdrop-filter:blur(8px)}
.overlay.active{display:flex}
.overlay-content{text-align:center}
#countdown-text{font-size:clamp(80px,15vw,200px);font-weight:900;color:var(--gold);text-shadow:0 0 40px rgba(251,191,36,0.5);animation:countPop .5s ease-out}
@keyframes countPop{0%{transform:scale(2);opacity:0}100%{transform:scale(1);opacity:1}}
.gameover-content{text-align:center;padding:30px}
.gameover-content h2{font-size:clamp(30px,5vw,52px);color:var(--gold);margin-bottom:10px}
.winner-name{font-size:clamp(22px,4vw,40px);font-weight:900;margin-bottom:18px}
.final-scores{display:flex;gap:18px;justify-content:center;margin-bottom:22px;flex-wrap:wrap}
.final-card{background:var(--bg-card);border-radius:var(--radius);padding:16px 28px;min-width:150px;border:3px solid;text-align:center}
.final-card .fc-name{font-size:16px;font-weight:700;margin-bottom:4px}
.final-card .fc-score{font-size:34px;font-weight:900}
.btn-restart{background:linear-gradient(135deg,#FFD54F,#FF8F00);color:#1a1a2e;font-family:'Prompt',sans-serif;font-size:clamp(15px,2.2vw,20px);font-weight:700;padding:12px 36px;border:none;border-radius:40px;cursor:pointer;transition:transform .15s;touch-action:manipulation}
.btn-restart:hover{transform:scale(1.05)}.btn-restart:active{transform:scale(0.95)}
.confirm-content{text-align:center;padding:30px}
.confirm-content h2{font-size:clamp(22px,4vw,34px);color:var(--gold);margin-bottom:18px}
.confirm-buttons{display:flex;gap:14px;justify-content:center}
.btn-cy,.btn-cn{font-family:'Prompt',sans-serif;font-size:17px;font-weight:700;padding:11px 28px;border:none;border-radius:30px;cursor:pointer;transition:transform .15s}
.btn-cy{background:var(--wrong);color:#FFF}.btn-cn{background:var(--bg-card2);color:var(--text);border:2px solid rgba(255,255,255,0.2)}
.btn-cy:hover,.btn-cn:hover{transform:scale(1.05)}

/* Win flash */
.win-flash{position:fixed;inset:0;z-index:45;pointer-events:none;opacity:0;transition:opacity .3s}
.win-flash.show{opacity:1;animation:winPulse 1s ease-out forwards}
@keyframes winPulse{0%{background:rgba(251,191,36,0.4)}100%{background:transparent}}

/* Exhaust particles */
.exhaust{position:absolute;width:4px;height:4px;border-radius:50%;pointer-events:none;z-index:3;animation:exhaustFade .6s ease-out forwards}
@keyframes exhaustFade{0%{opacity:.8;transform:translateY(0) scale(1)}100%{opacity:0;transform:translateY(30px) scale(0)}}

/* Confetti */
#confetti{position:fixed;inset:0;pointer-events:none;z-index:100;overflow:hidden}
.confetti-piece{position:absolute;top:-20px;animation:confettiFall linear forwards}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(110vh) rotate(720deg);opacity:0}}

@media(prefers-reduced-motion:reduce){.rocket-col,.ans-btn,.buzz-btn{transition:none!important}.confetti-piece,#countdown-text{animation:none!important}}
</style>
</head>
<body>
<canvas id="stars"></canvas>
<div id="confetti"></div>
<div class="win-flash" id="winFlash"></div>

<!-- ‚ïê‚ïê‚ïê SETUP ‚ïê‚ïê‚ïê -->
<div id="screen-setup" class="screen active">
  <div class="setup-title">Rocket Launch</div>
  <div class="setup-sub">‡∏à‡∏£‡∏ß‡∏î‡∏ó‡∏∞‡∏•‡∏∏‡∏≠‡∏ß‡∏Å‡∏≤‡∏® ‚Äî ‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡πá‡∏ß ‡∏ö‡∏¥‡∏ô‡∏™‡∏π‡∏á ‡∏ñ‡∏∂‡∏á‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏ô‡∏∞!</div>
  <div class="setup-grid">
    <div class="setup-card">
      <h3>2 ‡∏ó‡∏µ‡∏°</h3>
      <label>‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 1</label>
      <input id="inName1" value="‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á" maxlength="20">
      <label>‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 2</label>
      <input id="inName2" value="‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô" maxlength="20">
      <div class="team-preview">
        <div class="team-chip red" id="chip1">‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á</div>
        <div class="team-chip blue" id="chip2">‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</div>
      </div>
    </div>
    <div class="setup-card">
      <h3>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
      <label>‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label>
      <select id="inPack">
        <option value="math">üî¢ ‡∏Ñ‡∏ì‡∏¥‡∏ï ‚Äî ‡πÄ‡∏•‡∏Ç‡πÄ‡∏£‡πá‡∏ß</option>
        <option value="tfSci">‚úÖ ‡∏à‡∏£‡∏¥‡∏á/‡πÄ‡∏ó‡πá‡∏à ‚Äî ‡∏ß‡∏¥‡∏ó‡∏¢‡πå</option>
        <option value="tfSoc">‚úÖ ‡∏à‡∏£‡∏¥‡∏á/‡πÄ‡∏ó‡πá‡∏à ‚Äî ‡∏™‡∏±‡∏á‡∏Ñ‡∏°</option>
        <option value="eng">üî§ ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‚Äî ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</option>
      </select>
      <label>‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
      <select id="inTimer">
        <option value="30">30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="45">45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="60" selected>60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="90">90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="120">120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
      </select>
      <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ñ‡∏∂‡∏á‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</label>
      <select id="inGoal">
        <option value="8">8 ‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
        <option value="10" selected>10 ‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
        <option value="12">12 ‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
        <option value="15">15 ‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
      </select>
    </div>
  </div>
  <div class="svg-btn-container">
    <svg id="gameBtn" class="game-svg" viewBox="-20 -20 360 160" xmlns="http://www.w3.org/2000/svg" onclick="clickStart()">
      <defs>
        <linearGradient id="bgGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD54F"/><stop offset="100%" stop-color="#FF8F00"/></linearGradient>
        <filter id="btnSh" x="-20%" y="-20%" width="140%" height="160%"><feDropShadow dx="0" dy="8" stdDeviation="0" flood-color="#D84315"/></filter>
        <filter id="btnTSh" x="-20%" y="-20%" width="140%" height="160%"><feDropShadow dx="0" dy="2" stdDeviation="1" flood-color="rgba(0,0,0,0.3)"/></filter>
      </defs>
      <g class="svg-btn-group" transform-origin="160 55">
        <rect x="10" y="10" width="300" height="80" rx="40" fill="url(#bgGrad)" filter="url(#btnSh)" stroke="#FFF" stroke-width="5"/>
        <g class="svg-btn-content"><text x="160" y="62" font-family="'Prompt',sans-serif" font-size="32" font-weight="700" fill="#FFF" text-anchor="middle" letter-spacing="1" filter="url(#btnTSh)">üöÄ ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏à‡∏£‡∏ß‡∏î!</text></g>
        <g class="svg-loading-dots" opacity="0" transform="translate(160,55)"><circle class="sd1" cx="-30" cy="0" r="8" fill="#FFF"/><circle class="sd2" cx="0" cy="0" r="8" fill="#FFF"/><circle class="sd3" cx="30" cy="0" r="8" fill="#FFF"/></g>
      </g>
    </svg>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê GAME ‚ïê‚ïê‚ïê -->
<div id="screen-game" class="screen">
  <div class="game-layout">
    <div class="score-bar">
      <div class="score-team red" id="sb1">‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á: Lv <span id="lvl1">0</span></div>
      <div class="score-center"><span>‚è±</span><div class="timer-display" id="timerDisplay">60</div><span id="qCount">Q 0</span></div>
      <div class="score-team blue" id="sb2">‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô: Lv <span id="lvl2">0</span></div>
    </div>
    <div class="race-area" id="raceArea">
      <div class="finish-label" id="finishLabel">üåô ‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‚Äî Lv 10</div>
      <div class="finish-line"></div>
      <!-- level lines rendered by JS -->
      <div class="launchpad"></div>
      <div class="launchpad-label">LAUNCH PAD</div>
      <!-- Rocket 1 -->
      <div class="rocket-col" id="rocket1" style="bottom:0%">
        <div class="rocket-label red" id="rLabel1">‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á</div>
        <svg class="rocket-svg" viewBox="0 0 50 95" xmlns="http://www.w3.org/2000/svg">
          <path d="M25 2C18 14 9 28 9 48L9 62H41V48C41 28 32 14 25 2Z" fill="#EF4444"/>
          <rect x="9" y="52" width="32" height="4" fill="#B91C1C" opacity="0.5"/>
          <circle cx="25" cy="34" r="7" fill="#FEE2E2" stroke="#FFF" stroke-width="1.5"/>
          <path d="M9 54L1 72 13 63Z" fill="#B91C1C"/><path d="M41 54L49 72 37 63Z" fill="#B91C1C"/>
          <rect x="16" y="62" width="18" height="4" rx="2" fill="#4B5563"/>
          <g class="rocket-flame">
            <ellipse class="flame-outer" cx="25" cy="74" rx="10" ry="14" fill="#FBBF24" opacity="0.8"/>
            <ellipse class="flame-mid" cx="25" cy="72" rx="6" ry="9" fill="#F97316" opacity="0.9"/>
            <ellipse class="flame-inner" cx="25" cy="70" rx="3" ry="5" fill="#FFF" opacity="0.7"/>
          </g>
        </svg>
        <div class="level-badge" id="badge1">Lv 0</div>
      </div>
      <!-- Rocket 2 -->
      <div class="rocket-col" id="rocket2" style="bottom:0%">
        <div class="rocket-label blue" id="rLabel2">‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</div>
        <svg class="rocket-svg" viewBox="0 0 50 95" xmlns="http://www.w3.org/2000/svg">
          <path d="M25 2C18 14 9 28 9 48L9 62H41V48C41 28 32 14 25 2Z" fill="#3B82F6"/>
          <rect x="9" y="52" width="32" height="4" fill="#1D4ED8" opacity="0.5"/>
          <circle cx="25" cy="34" r="7" fill="#DBEAFE" stroke="#FFF" stroke-width="1.5"/>
          <path d="M9 54L1 72 13 63Z" fill="#1D4ED8"/><path d="M41 54L49 72 37 63Z" fill="#1D4ED8"/>
          <rect x="16" y="62" width="18" height="4" rx="2" fill="#4B5563"/>
          <g class="rocket-flame">
            <ellipse class="flame-outer" cx="25" cy="74" rx="10" ry="14" fill="#FBBF24" opacity="0.8"/>
            <ellipse class="flame-mid" cx="25" cy="72" rx="6" ry="9" fill="#F97316" opacity="0.9"/>
            <ellipse class="flame-inner" cx="25" cy="70" rx="3" ry="5" fill="#FFF" opacity="0.7"/>
          </g>
        </svg>
        <div class="level-badge" id="badge2">Lv 0</div>
      </div>
    </div>
    <div class="question-area">
      <div class="status-text" id="statusText">üîî ‡∏ó‡∏µ‡∏°‡πÑ‡∏´‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏Å‡∏î‡πÄ‡∏•‡∏¢!</div>
      <div class="q-text" id="qText"></div>
      <div class="answers" id="answersArea"></div>
      <div class="buzz-row">
        <button class="buzz-btn red" id="buzzBtn1" onclick="teamBuzz(0)">üöÄ ‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á (1)</button>
        <button class="buzz-btn blue" id="buzzBtn2" onclick="teamBuzz(1)">üöÄ ‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (2)</button>
      </div>
    </div>
  </div>
</div>

<!-- Overlays -->
<div id="overlay-countdown" class="overlay"><div class="overlay-content"><div id="countdown-text">3</div></div></div>
<div id="overlay-gameover" class="overlay">
  <div class="gameover-content">
    <h2>üèÜ ‡∏à‡∏ö‡πÄ‡∏Å‡∏°!</h2>
    <div class="winner-name" id="winnerName"></div>
    <div class="final-scores" id="finalScores"></div>
    <button class="btn-restart" onclick="backToSetup()">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
  </div>
</div>
<div id="overlay-confirm" class="overlay">
  <div class="confirm-content">
    <h2>‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤?</h2>
    <div class="confirm-buttons">
      <button class="btn-cy" onclick="confirmExit(true)">‡πÉ‡∏ä‡πà ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏¢</button>
      <button class="btn-cn" onclick="confirmExit(false)">‡πÑ‡∏°‡πà ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠</button>
    </div>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUESTION DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const TF = (q, a) => ({ text: q, choices: ['‡∏à‡∏£‡∏¥‡∏á','‡πÄ‡∏ó‡πá‡∏à'], correct: a ? 0 : 1 });
const MC = (q, cs, a) => ({ text: q, choices: cs, correct: a });

const STATIC_PACKS = {
  tfSci: [
    TF('‡πÇ‡∏•‡∏Å‡∏´‡∏°‡∏∏‡∏ô‡∏£‡∏≠‡∏ö‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå',true),
    TF('‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏°‡∏µ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á',false),
    TF('‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏î‡∏ó‡∏µ‡πà 100¬∞C',true),
    TF('‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏™‡∏∏‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ',false),
    TF('‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡∏§‡∏Å‡∏©‡πå',true),
    TF('‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®',false),
    TF('‡∏ô‡πâ‡∏≥‡∏°‡∏µ 3 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á ‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß ‡∏Å‡πä‡∏≤‡∏ã',true),
    TF('‡πÅ‡∏™‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á',true),
    TF('‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á',true),
    TF('‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏•‡∏π‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏°‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î‡∏ß‡∏≤‡∏á‡πÑ‡∏Ç‡πà',false),
    TF('‡πÄ‡∏û‡∏ä‡∏£‡πÅ‡∏Ç‡πá‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏´‡∏•‡πá‡∏Å',true),
    TF('‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏ß‡πà‡∏≤‡πÇ‡∏•‡∏Å',false),
    TF('‡∏û‡∏∑‡∏ä‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏™‡∏á',true),
    TF('‡∏õ‡∏•‡∏≤‡∏ß‡∏≤‡∏¨‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏•‡∏≤',false),
    TF('‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏Å',false),
    TF('‡∏î‡∏≤‡∏ß‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏°‡∏µ 206 ‡∏ä‡∏¥‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å',true),
    TF('‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á‡∏°‡∏µ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ H‚ÇÇO',false),
    TF('‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡∏•‡∏á‡∏™‡∏π‡πà‡∏û‡∏∑‡πâ‡∏ô',true),
    TF('‡πÑ‡∏î‡πÇ‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå‡∏Å‡∏±‡∏ö‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡πÄ‡∏Ñ‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏¢‡∏∏‡∏Ñ‡∏Å‡∏±‡∏ô',false),
    TF('‡∏™‡∏°‡∏≠‡∏á‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20% ‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢',true),
    TF('‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 0¬∞C ‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥',true),
    TF('‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏≥‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÑ‡∏î‡πâ',true),
    TF('‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ö‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏î‡∏ß‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå',false),
    TF('‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏´‡∏•‡πá‡∏Å',true),
  ],
  tfSoc: [
    TF('‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡∏∞‡∏¢‡∏≤‡πÑ‡∏´‡∏•‡∏•‡∏á‡∏™‡∏π‡πà‡∏≠‡πà‡∏≤‡∏ß‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡∏°‡∏µ 77 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏•‡∏≤‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡πÉ‡∏ï‡πâ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',false),
    TF('‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÅ‡∏õ‡∏ã‡∏¥‡∏ü‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏à‡∏µ‡∏ô‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏≤‡∏Å‡∏≠‡∏ß‡∏Å‡∏≤‡∏®‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≤‡πÄ‡∏õ‡∏•‡πà‡∏≤',false),
    TF('‡∏ó‡∏ß‡∏µ‡∏õ‡πÅ‡∏≠‡∏ü‡∏£‡∏¥‡∏Å‡∏≤‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ‡πÅ‡∏´‡πà‡∏á‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡∏¢‡∏∏‡πÇ‡∏£‡∏õ',false),
    TF('‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏µ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 6 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',true),
    TF('‡∏î‡∏≠‡∏¢‡∏≠‡∏¥‡∏ô‡∏ó‡∏ô‡∏ô‡∏ó‡πå‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢',true),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÑ‡∏ô‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢',false),
    TF('‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å 10 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',true),
    TF('‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡∏ó‡∏ß‡∏µ‡∏õ',true),
    TF('‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥‡πÑ‡∏ó‡∏¢‡∏°‡∏µ 4 ‡∏™‡∏µ',false),
    TF('‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÄ‡∏≠‡πÄ‡∏ß‡∏≠‡πÄ‡∏£‡∏™‡∏ï‡πå‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏û‡∏£‡∏∞‡∏ö‡∏£‡∏°‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä‡∏ß‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',false),
    TF('‡∏ó‡∏∞‡πÄ‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏™‡∏∞‡∏Æ‡∏≤‡∏£‡∏≤‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡∏°‡∏µ‡∏û‡∏£‡∏°‡πÅ‡∏î‡∏ô‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ö 4 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',true),
    TF('‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏≠‡∏ã‡∏≤‡∏Å‡∏≤',false),
    TF('‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÇ‡∏Ç‡∏á‡πÑ‡∏´‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢',true),
    TF('‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ö‡∏£‡∏π‡πÑ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô',true),
    TF('‡∏ó‡∏ß‡∏µ‡∏õ‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏ß‡∏µ‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',true),
    TF('‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏™‡∏°‡∏±‡∏¢‡∏£‡∏±‡∏ä‡∏Å‡∏≤‡∏•‡∏ó‡∏µ‡πà 5',false),
    TF('‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡πÉ‡∏ï‡πâ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢',true),
  ],
  eng: [
    MC('"Moon" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå','‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå','‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß','‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤'],1),
    MC('"Rocket" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô','‡∏à‡∏£‡∏ß‡∏î','‡πÄ‡∏£‡∏∑‡∏≠','‡∏£‡∏ñ‡πÑ‡∏ü'],1),
    MC('"Star" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß','‡πÄ‡∏°‡∏Ü','‡∏ù‡∏ô','‡∏•‡∏°'],0),
    MC('"Earth" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏î‡∏¥‡∏ô','‡∏ô‡πâ‡∏≥','‡πÇ‡∏•‡∏Å','‡πÑ‡∏ü'],2),
    MC('"Sun" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå','‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå','‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß','‡πÄ‡∏°‡∏Ü'],1),
    MC('"Water" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ô‡πâ‡∏≥','‡πÑ‡∏ü','‡∏•‡∏°','‡∏î‡∏¥‡∏ô'],0),
    MC('"Fire" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ô‡πâ‡∏≥','‡πÑ‡∏ü','‡∏•‡∏°','‡πÅ‡∏™‡∏á'],1),
    MC('"Sky" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ó‡∏∞‡πÄ‡∏•','‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤','‡∏†‡∏π‡πÄ‡∏Ç‡∏≤','‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥'],1),
    MC('"Dog" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÅ‡∏°‡∏ß','‡∏™‡∏∏‡∏ô‡∏±‡∏Ç','‡∏ô‡∏Å','‡∏õ‡∏•‡∏≤'],1),
    MC('"Cat" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏™‡∏∏‡∏ô‡∏±‡∏Ç','‡πÅ‡∏°‡∏ß','‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢','‡∏ô‡∏Å'],1),
    MC('"Book" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤','‡∏î‡∏¥‡∏ô‡∏™‡∏≠','‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠','‡∏™‡∏°‡∏∏‡∏î'],2),
    MC('"Teacher" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô','‡∏Ñ‡∏£‡∏π','‡∏´‡∏°‡∏≠','‡∏û‡πà‡∏≠'],1),
    MC('"School" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ö‡πâ‡∏≤‡∏ô','‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô','‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•','‡∏ß‡∏±‡∏î'],1),
    MC('"Happy" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÄ‡∏®‡∏£‡πâ‡∏≤','‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç','‡πÇ‡∏Å‡∏£‡∏ò','‡∏Å‡∏•‡∏±‡∏ß'],1),
    MC('"Big" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÄ‡∏•‡πá‡∏Å','‡πÉ‡∏´‡∏ç‡πà','‡∏™‡∏π‡∏á','‡∏ï‡πà‡∏≥'],1),
    MC('"Red" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô','‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß','‡πÅ‡∏î‡∏á','‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á'],2),
    MC('"Apple" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏™‡πâ‡∏°','‡∏Å‡∏•‡πâ‡∏ß‡∏¢','‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡∏•','‡∏≠‡∏á‡∏∏‡πà‡∏ô'],2),
    MC('"Rain" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÅ‡∏î‡∏î','‡∏ù‡∏ô','‡∏•‡∏°','‡∏´‡∏¥‡∏°‡∏∞'],1),
    MC('"Mountain" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥','‡∏ó‡∏∞‡πÄ‡∏•','‡∏†‡∏π‡πÄ‡∏Ç‡∏≤','‡∏õ‡πà‡∏≤'],2),
    MC('"Friend" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏®‡∏±‡∏ï‡∏£‡∏π','‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô','‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß','‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ö‡πâ‡∏≤‡∏ô'],1),
    MC('"Hand" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡πÄ‡∏ó‡πâ‡∏≤','‡∏°‡∏∑‡∏≠','‡∏´‡∏±‡∏ß','‡∏ï‡∏≤'],1),
    MC('"Food" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ô‡πâ‡∏≥','‡∏≠‡∏≤‡∏´‡∏≤‡∏£','‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤','‡∏ö‡πâ‡∏≤‡∏ô'],1),
    MC('"Fast" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ä‡πâ‡∏≤','‡πÄ‡∏£‡πá‡∏ß','‡∏´‡∏¢‡∏∏‡∏î','‡πÄ‡∏î‡∏¥‡∏ô'],1),
    MC('"Night" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô','‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô','‡πÄ‡∏ä‡πâ‡∏≤','‡πÄ‡∏¢‡πá‡∏ô'],1),
    MC('"Fly" ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤?',['‡∏ß‡∏¥‡πà‡∏á','‡∏ö‡∏¥‡∏ô','‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥','‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î'],1),
  ],
};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MATH GENERATOR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function randInt(a,b){ return a + Math.floor(Math.random()*(b-a+1)); }
function shuffle(arr){ const a=[...arr]; for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a; }

function genMathQ(){
  const ops=['+','-','√ó'];
  const op=ops[randInt(0,2)];
  let a,b,ans;
  if(op==='+'){a=randInt(3,50);b=randInt(3,50);ans=a+b;}
  else if(op==='-'){a=randInt(10,60);b=randInt(1,a-1);ans=a-b;}
  else{a=randInt(2,12);b=randInt(2,12);ans=a*b;}
  const set=new Set([ans]);
  while(set.size<4){const off=randInt(1,8)*(Math.random()>.5?1:-1);const w=ans+off;if(w>=0&&!set.has(w))set.add(w);}
  const choices=shuffle([...set]);
  return{text:`${a} ${op} ${b} = ?`,choices:choices.map(String),correct:choices.indexOf(ans)};
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GAME STATE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const G={
  state:'setup',
  teams:[{name:'‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á',level:0},{name:'‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô',level:0}],
  maxLevel:10,
  timerMax:60,timerLeft:60,timerInterval:null,
  pack:'math',
  questions:[],qIndex:0,currentQ:null,
  activeTeam:null,
  qAnswered:0,
  pausedState:null,
};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUDIO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let audioCtx=null;
function ensureAudio(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();if(audioCtx.state==='suspended')audioCtx.resume();}
function playTone(f,d,t='sine',v=0.18){ensureAudio();const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.connect(g);g.connect(audioCtx.destination);o.type=t;o.frequency.setValueAtTime(f,audioCtx.currentTime);g.gain.setValueAtTime(v,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+d);o.start();o.stop(audioCtx.currentTime+d);}
function sfxCountdown(){playTone(440,.15,'square',.12)}
function sfxGo(){playTone(880,.3,'square',.15);setTimeout(()=>playTone(1100,.3,'square',.12),100)}
function sfxBuzz(){playTone(600,.15,'square',.15);setTimeout(()=>playTone(800,.15,'square',.12),80)}
function sfxCorrect(){playTone(523,.12);setTimeout(()=>playTone(659,.12),100);setTimeout(()=>playTone(784,.18),200)}
function sfxWrong(){playTone(200,.3,'sawtooth',.2);setTimeout(()=>playTone(150,.4,'sawtooth',.15),200)}
function sfxBoost(){playTone(400,.08);setTimeout(()=>playTone(600,.08),60);setTimeout(()=>playTone(900,.15),120)}
function sfxDrop(){playTone(500,.1,'sawtooth',.15);setTimeout(()=>playTone(300,.2,'sawtooth',.12),100)}
function sfxWin(){[523,659,784,1047].forEach((f,i)=>setTimeout(()=>playTone(f,.3,'triangle',.15),i*120))}
function sfxTick(){playTone(900,.05,'sine',.08)}
function sfxMoonReach(){[523,659,784,880,1047,1319].forEach((f,i)=>setTimeout(()=>playTone(f,.2,'sine',.15),i*80))}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STARS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function initStars(){const c=document.getElementById('stars');const ctx=c.getContext('2d');function resize(){c.width=innerWidth;c.height=innerHeight}resize();addEventListener('resize',resize);const stars=Array.from({length:150},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.8+.3,a:Math.random(),s:(Math.random()*.015+.003)*(Math.random()<.5?1:-1)}));(function draw(){ctx.clearRect(0,0,c.width,c.height);stars.forEach(s=>{s.a+=s.s;if(s.a>1||s.a<.1)s.s*=-1;ctx.fillStyle=`rgba(255,255,255,${s.a})`;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill()});requestAnimationFrame(draw)})()}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function showScreen(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active')}
function showOverlay(id){document.getElementById(id).classList.add('active')}
function hideOverlay(id){document.getElementById(id).classList.remove('active')}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFETTI ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function launchConfetti(){const c=document.getElementById('confetti');c.innerHTML='';const colors=['#22D3EE','#FB923C','#4ADE80','#FBBF24','#F87171','#C084FC','#F472B6','#34D399'];for(let i=0;i<80;i++){const p=document.createElement('div');p.className='confetti-piece';p.style.left=Math.random()*100+'%';p.style.background=colors[Math.floor(Math.random()*colors.length)];p.style.width=(6+Math.random()*10)+'px';p.style.height=(6+Math.random()*10)+'px';p.style.borderRadius=Math.random()>.5?'50%':'2px';p.style.animationDuration=(2+Math.random()*3)+'s';p.style.animationDelay=Math.random()*2+'s';p.style.opacity=.7+Math.random()*.3;c.appendChild(p)}setTimeout(()=>c.innerHTML='',6000)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TIMER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function startTimer(resume=false){if(!resume)G.timerLeft=G.timerMax;updateTimerDisplay();clearInterval(G.timerInterval);G.timerInterval=setInterval(()=>{G.timerLeft--;updateTimerDisplay();if(G.timerLeft<=5&&G.timerLeft>0)sfxTick();if(G.timerLeft<=0){clearInterval(G.timerInterval);onTimeUp()}},1000)}
function stopTimer(){clearInterval(G.timerInterval)}
function updateTimerDisplay(){const el=document.getElementById('timerDisplay');el.textContent=G.timerLeft;el.classList.toggle('warning',G.timerLeft<=5)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LEVEL LINES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderLevelLines(){
  const area=document.getElementById('raceArea');
  area.querySelectorAll('.level-line').forEach(e=>e.remove());
  for(let i=1;i<=G.maxLevel;i++){
    const line=document.createElement('div');
    line.className='level-line';
    line.style.bottom=(i/G.maxLevel)*88+'%';
    area.appendChild(line);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê START ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function clickStart(){
  ensureAudio();
  const btn=document.getElementById('gameBtn');
  if(btn.classList.contains('is-starting'))return;
  btn.classList.add('is-starting');

  G.teams[0].name=document.getElementById('inName1').value.trim()||'‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á';
  G.teams[1].name=document.getElementById('inName2').value.trim()||'‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô';
  G.teams[0].level=0; G.teams[1].level=0;
  G.pack=document.getElementById('inPack').value;
  G.timerMax=parseInt(document.getElementById('inTimer').value);
  G.maxLevel=parseInt(document.getElementById('inGoal').value);
  G.qAnswered=0; G.qIndex=0; G.activeTeam=null;

  // Prepare questions
  if(G.pack==='math'){G.questions=[];} // generated on the fly
  else{G.questions=shuffle([...STATIC_PACKS[G.pack]]);}

  // Update labels
  document.getElementById('sb1').innerHTML=`${G.teams[0].name}: Lv <span id="lvl1">0</span>`;
  document.getElementById('sb2').innerHTML=`${G.teams[1].name}: Lv <span id="lvl2">0</span>`;
  document.getElementById('rLabel1').textContent=G.teams[0].name;
  document.getElementById('rLabel2').textContent=G.teams[1].name;
  document.getElementById('buzzBtn1').innerHTML=`üöÄ ${G.teams[0].name} (1)`;
  document.getElementById('buzzBtn2').innerHTML=`üöÄ ${G.teams[1].name} (2)`;
  document.getElementById('finishLabel').textContent=`üåô ‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‚Äî Lv ${G.maxLevel}`;

  renderLevelLines();
  updateRockets();

  setTimeout(()=>{
    btn.classList.remove('is-starting');
    showScreen('screen-game');
    runCountdown();
  },700);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COUNTDOWN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function runCountdown(){
  showOverlay('overlay-countdown');
  const el=document.getElementById('countdown-text');
  let count=3;el.textContent=count;el.style.color='var(--gold)';sfxCountdown();
  const iv=setInterval(()=>{
    count--;
    if(count>0){el.textContent=count;el.style.animation='none';el.offsetHeight;el.style.animation='';sfxCountdown();}
    else{el.textContent='GO!';el.style.animation='none';el.offsetHeight;el.style.animation='';el.style.color='var(--correct)';sfxGo();clearInterval(iv);
      setTimeout(()=>{hideOverlay('overlay-countdown');el.style.color='var(--gold)';G.state='playing';startTimer();loadQuestion();},600);
    }
  },800);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUESTIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function getNextQuestion(){
  if(G.pack==='math') return genMathQ();
  if(G.qIndex>=G.questions.length){G.questions=shuffle(G.questions);G.qIndex=0;} // re-shuffle & loop
  return G.questions[G.qIndex++];
}

function loadQuestion(){
  if(G.state!=='playing')return;
  G.activeTeam=null;
  G.currentQ=getNextQuestion();
  G.qAnswered++;

  document.getElementById('qCount').textContent=`Q ${G.qAnswered}`;
  document.getElementById('qText').textContent=G.currentQ.text;
  document.getElementById('statusText').textContent='üîî ‡∏ó‡∏µ‡∏°‡πÑ‡∏´‡∏ô‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ ‡∏Å‡∏î‡πÄ‡∏•‡∏¢!';
  document.getElementById('statusText').className='status-text';

  // Render answer buttons (dimmed until buzz)
  const area=document.getElementById('answersArea');
  area.innerHTML='';
  G.currentQ.choices.forEach((ch,i)=>{
    const btn=document.createElement('button');
    btn.className='ans-btn';
    btn.textContent=ch;
    btn.dataset.idx=i;
    btn.onclick=()=>pickAnswer(i);
    area.appendChild(btn);
  });

  setBuzzEnabled(true);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BUZZ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function teamBuzz(idx){
  if(G.state!=='playing'||G.activeTeam!==null)return;
  sfxBuzz();
  G.activeTeam=idx;
  const t=G.teams[idx];
  const cls=idx===0?'red':'blue';

  document.getElementById('statusText').textContent=`${t.name} ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏≠‡∏ö...`;
  document.getElementById('statusText').className=`status-text active-team ${cls}`;
  setBuzzEnabled(false);

  // Activate answer buttons
  document.querySelectorAll('.ans-btn').forEach(b=>b.classList.add('active'));
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PICK ANSWER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function pickAnswer(idx){
  if(G.activeTeam===null||G.state!=='playing')return;
  const teamIdx=G.activeTeam;
  G.activeTeam=null; // prevent double-processing

  const btns=document.querySelectorAll('.ans-btn');
  btns.forEach(b=>{b.classList.remove('active');b.style.pointerEvents='none'});

  const isCorrect=idx===G.currentQ.correct;

  // Flash correct/wrong
  btns[idx].classList.add(isCorrect?'correct-flash':'wrong-flash');
  if(!isCorrect) btns[G.currentQ.correct].classList.add('correct-flash');

  if(isCorrect){
    sfxCorrect();
    G.teams[teamIdx].level=Math.min(G.teams[teamIdx].level+1,G.maxLevel);
    boostRocket(teamIdx);
  } else {
    sfxWrong();
    G.teams[teamIdx].level=Math.max(G.teams[teamIdx].level-1,0);
    dropRocket(teamIdx);
  }
  updateRockets();
  updateLevelDisplays();

  // Check win ‚Äî set state immediately to prevent onTimeUp race
  if(G.teams[teamIdx].level>=G.maxLevel){
    G.state='gameOver';
    stopTimer();
    setTimeout(()=>moonWin(teamIdx),600);
    return;
  }

  // Next question after brief pause
  setTimeout(()=>{if(G.state==='playing')loadQuestion();},900);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROCKET ANIMATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function updateRockets(){
  for(let i=0;i<2;i++){
    const el=document.getElementById(`rocket${i+1}`);
    const pct=(G.teams[i].level/G.maxLevel)*88;
    el.style.bottom=pct+'%';
  }
}

function updateLevelDisplays(){
  for(let i=0;i<2;i++){
    const lv=G.teams[i].level;
    const el=document.getElementById(`lvl${i+1}`);
    if(el)el.textContent=lv;
    document.getElementById(`badge${i+1}`).textContent=`Lv ${lv}`;
  }
}

function boostRocket(idx){
  const el=document.getElementById(`rocket${idx+1}`);
  el.classList.add('boosting');
  sfxBoost();
  spawnExhaust(el);
  setTimeout(()=>el.classList.remove('boosting'),700);
}

function dropRocket(idx){
  const el=document.getElementById(`rocket${idx+1}`);
  el.classList.add('shake');
  sfxDrop();
  setTimeout(()=>el.classList.remove('shake'),500);
}

function spawnExhaust(rocketEl){
  const rect=rocketEl.getBoundingClientRect();
  const cx=rect.left+rect.width/2;
  const cy=rect.bottom;
  const colors=['#FBBF24','#F97316','#FFF','#FB923C'];
  for(let i=0;i<8;i++){
    const p=document.createElement('div');
    p.className='exhaust';
    p.style.left=(cx-2+randInt(-10,10))+'px';
    p.style.top=(cy+randInt(0,10))+'px';
    p.style.background=colors[randInt(0,colors.length-1)];
    p.style.animationDelay=(Math.random()*0.2)+'s';
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),700);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WIN CONDITIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function moonWin(idx){
  if(G.state==='gameOver')return; // guard against double-fire
  G.state='gameOver';
  stopTimer();
  sfxMoonReach();
  const fl=document.getElementById('winFlash');
  fl.classList.add('show');
  setTimeout(()=>fl.classList.remove('show'),1200);
  setTimeout(()=>showGameOver(idx),800);
}

function onTimeUp(){
  if(G.state!=='playing')return;
  G.state='gameOver';
  const l0=G.teams[0].level, l1=G.teams[1].level;
  let winner=l0>l1?0:l1>l0?1:-1;
  setTimeout(()=>showGameOver(winner),500);
}

function showGameOver(winnerIdx){
  if(winnerIdx!==-1){sfxWin();launchConfetti();}
  else{playTone(440,.3,'triangle',.1);} // subtle tone for tie
  const wn=document.getElementById('winnerName');
  if(winnerIdx===-1){
    wn.textContent='ü§ù ‡πÄ‡∏™‡∏°‡∏≠!';
    wn.style.color='var(--gold)';
  } else {
    const t=G.teams[winnerIdx];
    wn.textContent=`üöÄ ${t.name} ‡∏ä‡∏ô‡∏∞!`;
    wn.style.color=winnerIdx===0?'var(--team1)':'var(--team2)';
  }
  const sc=document.getElementById('finalScores');
  sc.innerHTML='';
  G.teams.forEach((t,i)=>{
    const c=document.createElement('div');
    c.className='final-card';
    c.style.borderColor=i===0?'var(--team1)':'var(--team2)';
    c.innerHTML=`<div class="fc-name" style="color:${i===0?'var(--team1)':'var(--team2)'}">${t.name}</div><div class="fc-score" style="color:${i===0?'var(--team1)':'var(--team2)'}">Lv ${t.level}</div>`;
    sc.appendChild(c);
  });
  showOverlay('overlay-gameover');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HELPERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function setBuzzEnabled(on){
  document.getElementById('buzzBtn1').disabled=!on;
  document.getElementById('buzzBtn2').disabled=!on;
}

function backToSetup(){
  hideOverlay('overlay-gameover');
  hideOverlay('overlay-confirm');
  stopTimer();
  G.state='setup';G.pausedState=null;
  showScreen('screen-setup');
}

function showConfirmExit(){
  if(G.state==='setup'||G.state==='gameOver')return;
  G.pausedState=G.state;G.state='paused';
  stopTimer();showOverlay('overlay-confirm');
}
function confirmExit(yes){
  hideOverlay('overlay-confirm');
  if(yes){backToSetup();}
  else{G.state=G.pausedState||'playing';G.pausedState=null;startTimer(true);}
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê KEYBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.addEventListener('keydown',e=>{
  if(e.key==='1'&&G.state==='playing')teamBuzz(0);
  else if(e.key==='2'&&G.state==='playing')teamBuzz(1);
  else if(e.key==='Escape'){
    if(G.state==='paused')confirmExit(false);
    else if(G.state!=='setup'&&G.state!=='gameOver')showConfirmExit();
  }
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TEAM PREVIEW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.getElementById('inName1').addEventListener('input',e=>{document.getElementById('chip1').textContent=e.target.value||'‡∏ó‡∏µ‡∏°‡πÅ‡∏î‡∏á'});
document.getElementById('inName2').addEventListener('input',e=>{document.getElementById('chip2').textContent=e.target.value||'‡∏ó‡∏µ‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô'});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
initStars();
</script>
</body>
</html>
